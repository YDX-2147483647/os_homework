# [实验1 单处理机进程调度](https://lexue.bit.edu.cn/mod/programming/view.php?id=365470)

## 内容

编写一个单处理机下的进程调度程序，模拟操作系统对进程的调度。

## 目的

进程是操作系统中最基本、最重要的概念，进程调度又是操作系统的核心模块。本实验要求学生独立设计并实现进程调度模拟程序，以加深对进程控制块概念和各种进程调度算法的理解。

## 要求

- 可以随机输入若干进程，支持先来先服务、短作业优先、最短剩余时间优先、时间片轮转、动态优先级调度算法，能够输出进程的调度过程。具体信息见测试用例格式说明。

- 每个进程由一个进程控制块表示。

- 实现调度算法：

  1. 先来先服务

     进程到达时间可由进程创建时间表示。进程到达时间相同时，优先处理进程号小的进程。

  2. 短作业优先

     可指定进程要求的运行时间。进程运行时间相同时，按照先来先服务原则进行处理。

  3. 最短剩余时间优先

     可指定进程要求的运行时间。进程运行时间相同时，按照先来先服务原则进行处理。

  4. 时间片轮转

     可指定生成时间片大小。进程到达时间相同时，优先处理进程号小的进程；进程执行完一个时间片进入就绪队列时，其优先级低于首次进入就绪队列的进程。

  5. 动态优先级

     可指定进程的初始优先级（优先级与优先数成反比，优先级最高为0），优先级改变遵循下列原则：进程在就绪队列中每停留一个时间片（停留时间>0），优先级加1，进程每运行一个时间片，优先级减3。进程到达时间相同时，优先处理进程号小的进程，且仅在时间片完或进程运行结束时发生进程调度。


## 测试用例格式如下：

输入：

```
调度算法
进程号/到达时间/运行时间/优先级/时间片
```

其中“调度算法”是相应编号。


输出：

```
调度顺序/进程号/开始运行时间/结束运行时间/优先级
```

## 潜在的问题

- 输入时，要求进程号从小到大。

## 测试用例

> Gantt 图中标号表示优先数。

### 9

```
4
1/1/5/0/3
2/2/2/0/3
3/2/9/0/3
4/3/9/0/3
5/6/10/0/3
6/6/9/0/3
7/6/9/0/3
8/7/8/0/3
9/9/6/0/3
10/9/10/0/3
```

共十个任务。（`id`，`priority`不一定严格一致）

```mermaid
gantt
dateFormat SSS
axisFormat %L ms

section 1
0: milestone, 001, 0
0: 001, 004
0: 012, 014

section 2
0: milestone, 002, 0
0: 004, 006

section 3
0: milestone, 002, 0
0: 006, 009
0: 032, 035
0: 056, 059

section 4
0: milestone, 003, 0
0: 009, 012
0: 035, 038
0: 059, 062

section 5
0: milestone, 006, 0
0: 014, 017
0: 038, 041
0: 062, 065
0: 076, 077

section 6
0: milestone, 006, 0
0: 017, 020
0: 041, 044
0: 065, 068

section 7
0: milestone, 006, 0
0: 020, 023
0: 044, 047
0: 068, 071

section 8
0: milestone, 007, 0
0: 023, 026
0: 047, 050
0: 071, 073

section 9
0: milestone, 009, 0
0: 026, 029
0: 050, 053

section 10
0: milestone, 009, 0
0: 029, 032
0: 053, 056
0: 073, 076
0: 077, 078
```

根据测试用例，“进程执行完一个时间片进入就绪队列时，其优先级低于首次进入就绪队列的进程”中的优先级只是瞬时的。换句话说，一旦进程进入了队列，后面新来的进程就不再可能排到它前面，即使从未运行过也不行。

### 5

```
5
1/0/3/1/2
2/0/4/1/2
3/0/2/3/2
4/2/1/1/2
5/2/4/4/2
```

```
1/1/0/2/4
2/2/2/4/3
3/4/4/5/3
4/3/5/7/3
5/1/7/8/4
6/2/8/10/3
7/5/10/12/3
8/5/12/14/6
```

```mermaid
gantt
dateFormat SSS
axisFormat %L ms

section 1
1: milestone, 000, 0
4: 000, 002
4: 007, 008

section 2
1: milestone, 000, 0
3: 002, 004
3: 008, 010

section 3
3: milestone, 000, 0
3: 005, 007

section 4
1: milestone, 002, 0
3: 004, 005

section 5
4: milestone, 002, 0
3: 010, 012
6: 012, 014
```

- 优先数最小是零。
- 在时间片中途到达的任务，初次调度时优先级就已经变了。

## 15

下面是错误的调度计划。230 ms 起进程1、4的运行顺序不对。

```mermaid
gantt
dateFormat SSS
axisFormat %L ms

section 1
29: milestone, 200, 0
31: 230, 270
31: 390, 430
32: 510, 530

section 2
26: milestone, 100, 0
28: 120, 160
30: 190, 230
31: 310, 350

section 3
27: milestone, 150, 0
29: 160, 190

section 4
30: milestone, 000, 0
33: 000, 040
30: 270, 310
30: 430, 470
31: 530, 570
33: 580, 620

section 5
28: milestone, 040, 0
31: 040, 080
34: 080, 120
31: 350, 390
32: 470, 510
33: 570, 580
```
